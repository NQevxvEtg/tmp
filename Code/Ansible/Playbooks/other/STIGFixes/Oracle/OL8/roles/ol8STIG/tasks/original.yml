- name: populate package facts
  package_facts:
# R-248519 OL08-00-030180
- name: stigrule_248519_audit
  yum:
    name: audit
    state: "{{ ol8STIG_stigrule_248519_audit_State }}"
  when: ol8STIG_stigrule_248519_Manage
# R-248520 OL08-00-030181
- name: check if auditd.service is installed
  shell: ! systemctl list-unit-files | grep "^auditd.service[ \t]\+"
  changed_when: False
  check_mode: no
  register: result
  failed_when: result.rc > 1
- name: stigrule_248520_auditd_enable
  service:
    name: auditd.service
    enabled: "{{ ol8STIG_stigrule_248520_auditd_enable_Enabled }}"
  when:
    - ol8STIG_stigrule_248520_Manage
    - result.rc == 0
# R-248520 OL08-00-030181
- name: check if auditd.service is installed
  shell: ! systemctl list-unit-files | grep "^auditd.service[ \t]\+"
  changed_when: False
  check_mode: no
  register: result
  failed_when: result.rc > 1
- name: stigrule_248520_auditd_start
  service:
    name: auditd.service
    state: "{{ ol8STIG_stigrule_248520_auditd_start_State }}"
  when:
    - ol8STIG_stigrule_248520_Manage
    - result.rc == 0
# R-248526 OL08-00-010040
- name: stigrule_248526_banner
  lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '(?i)^\s*banner\s+'
    line: "{{ ol8STIG_stigrule_248526_banner_Line }}"
  notify: ssh_restart
  when:
    - ol8STIG_stigrule_248526_Manage
    - "'openssh-server' in packages"
# R-248527 OL08-00-010049
- name: stigrule_248527__etc_dconf_db_local_d_01_banner_message
  ini_file:
    path: /etc/dconf/db/local.d/01-banner-message
    section: org/gnome/login-screen
    option: banner-message-enable
    value: "{{ ol8STIG_stigrule_248527__etc_dconf_db_local_d_01_banner_message_Value }}"
    no_extra_spaces: yes
  notify: dconf_update
  when:
    - ol8STIG_stigrule_248527_Manage
    - "'dconf' in packages"
# R-248528 OL08-00-010050
- name: stigrule_248528__etc_dconf_db_local_d_01_banner_message
  ini_file:
    path: /etc/dconf/db/local.d/01-banner-message
    section: org/gnome/login-screen
    option: banner-message-text
    value: "{{ ol8STIG_stigrule_248528__etc_dconf_db_local_d_01_banner_message_Value }}"
    no_extra_spaces: yes
  notify: dconf_update
  when:
    - ol8STIG_stigrule_248528_Manage
    - "'dconf' in packages"
# R-248529 OL08-00-010060
- name: stigrule_248529__etc_issue
  copy:
    dest: "{{ ol8STIG_stigrule_248529__etc_issue_Dest }}"
    content: "{{ ol8STIG_stigrule_248529__etc_issue_Content }}"
  when:
    - ol8STIG_stigrule_248529_Manage
# R-248530 OL08-00-010070
- name: stigrule_248530__etc_rsyslog_conf
  lineinfile:
    path: /etc/rsyslog.conf
    line: "{{ ol8STIG_stigrule_248530__etc_rsyslog_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248530_Manage
# R-248533 OL08-00-010110
- name: stigrule_248533__etc_login_defs
  lineinfile:
    path: /etc/login.defs
    regexp: '^ENCRYPT_METHOD'
    line: "{{ ol8STIG_stigrule_248533__etc_login_defs_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248533_Manage
# R-248535 OL08-00-010130
- name: stigrule_248535__etc_login_defs
  lineinfile:
    path: /etc/login.defs
    regexp: '^SHA_CRYPT_MIN_ROUNDS'
    line: "{{ ol8STIG_stigrule_248535__etc_login_defs_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248535_Manage
# R-248541 OL08-00-010151
- name: stigrule_248541__usr_lib_systemd_system_rescue_service
  ini_file:
    path: /usr/lib/systemd/system/rescue.service
    section: Service
    option: ExecStart
    value: "{{ ol8STIG_stigrule_248541__usr_lib_systemd_system_rescue_service_Value }}"
    no_extra_spaces: yes
  when:
    - ol8STIG_stigrule_248541_Manage
# R-248542 OL08-00-010152
- name: stigrule_248542__usr_lib_systemd_system_emergency_service
  ini_file:
    path: /usr/lib/systemd/system/emergency.service
    section: Service
    option: ExecStart
    value: "{{ ol8STIG_stigrule_248542__usr_lib_systemd_system_emergency_service_Value }}"
    no_extra_spaces: yes
  when:
    - ol8STIG_stigrule_248542_Manage
# R-248546 OL08-00-010162
- name: stigrule_248546_krb5_workstation
  yum:
    name: krb5-workstation
    state: "{{ ol8STIG_stigrule_248546_krb5_workstation_State }}"
  when: ol8STIG_stigrule_248546_Manage
# R-248548 OL08-00-010170
- name: stigrule_248548__etc_selinux_config
  lineinfile:
    path: /etc/selinux/config
    regexp: '^SELINUX='
    line: "{{ ol8STIG_stigrule_248548__etc_selinux_config_Line }}"
    create: yes
  notify: do_reboot
  when:
    - ol8STIG_stigrule_248548_Manage
# R-248549 OL08-00-010171
- name: stigrule_248549_policycoreutils
  yum:
    name: policycoreutils
    state: "{{ ol8STIG_stigrule_248549_policycoreutils_State }}"
  when: ol8STIG_stigrule_248549_Manage
# R-248552 OL08-00-010200
- name: stigrule_248552_ClientAliveCountMax
  lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '(?i)^\s*ClientAliveCountMax\s+'
    line: "{{ ol8STIG_stigrule_248552_ClientAliveCountMax_Line }}"
  notify: ssh_restart
  when:
    - ol8STIG_stigrule_248552_Manage
    - "'openssh-server' in packages"
# R-248553 OL08-00-010201
- name: stigrule_248553_ClientAliveInterval
  lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '(?i)^\s*ClientAliveInterval\s+'
    line: "{{ ol8STIG_stigrule_248553_ClientAliveInterval_Line }}"
  notify: ssh_restart
  when:
    - ol8STIG_stigrule_248553_Manage
    - "'openssh-server' in packages"
# R-248562 OL08-00-010291
- name: stigrule_248562__etc_sysconfig_sshd
  lineinfile:
    path: /etc/sysconfig/sshd
    regexp: '^# CRYPTO_POLICY='
    line: "{{ ol8STIG_stigrule_248562__etc_sysconfig_sshd_Line }}"
    create: yes
  notify: do_reboot
  when:
    - ol8STIG_stigrule_248562_Manage
# R-248565 OL08-00-010294
- name: stigrule_248565__etc_crypto_policies_back_ends_opensslcnf_config
  lineinfile:
    path: /etc/crypto-policies/back-ends/opensslcnf.config
    regexp: '^MinProtocol = '
    line: "{{ ol8STIG_stigrule_248565__etc_crypto_policies_back_ends_opensslcnf_config_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248565_Manage
# R-248566 OL08-00-010295
- name: stigrule_248566__etc_crypto_policies_back_ends_opensslcnf_config
  lineinfile:
    path: /etc/crypto-policies/back-ends/opensslcnf.config
    line: "{{ ol8STIG_stigrule_248566__etc_crypto_policies_back_ends_opensslcnf_config_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248566_Manage
# R-248575 OL08-00-010371
- name: stigrule_248575__etc_dnf_dnf_conf
  ini_file:
    path: /etc/dnf/dnf.conf
    section: main
    option: localpkg_gpgcheck
    value: "{{ ol8STIG_stigrule_248575__etc_dnf_dnf_conf_Value }}"
    no_extra_spaces: yes
  when:
    - ol8STIG_stigrule_248575_Manage
# R-248576 OL08-00-010372
- name: stigrule_248576__etc_sysctl_d_99_sysctl_conf
  lineinfile:
    path: /etc/sysctl.d/99-sysctl.conf
    regexp: '^kernel.kexec_load_disabled = '
    line: "{{ ol8STIG_stigrule_248576__etc_sysctl_d_99_sysctl_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248576_Manage
# R-248577 OL08-00-010373
- name: stigrule_248577__etc_sysctl_d_99_sysctl_conf
  lineinfile:
    path: /etc/sysctl.d/99-sysctl.conf
    regexp: '^fs.protected_symlinks = '
    line: "{{ ol8STIG_stigrule_248577__etc_sysctl_d_99_sysctl_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248577_Manage
# R-248578 OL08-00-010374
- name: stigrule_248578__etc_sysctl_d_99_sysctl_conf
  lineinfile:
    path: /etc/sysctl.d/99-sysctl.conf
    regexp: '^fs.protected_hardlinks = '
    line: "{{ ol8STIG_stigrule_248578__etc_sysctl_d_99_sysctl_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248578_Manage
# R-248579 OL08-00-010375
- name: stigrule_248579__etc_sysctl_d_99_sysctl_conf
  lineinfile:
    path: /etc/sysctl.d/99-sysctl.conf
    regexp: '^kernel.dmesg_restrict = '
    line: "{{ ol8STIG_stigrule_248579__etc_sysctl_d_99_sysctl_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248579_Manage
# R-248580 OL08-00-010376
- name: stigrule_248580__etc_sysctl_d_99_sysctl_conf
  lineinfile:
    path: /etc/sysctl.d/99-sysctl.conf
    regexp: '^kernel.perf_event_paranoid = '
    line: "{{ ol8STIG_stigrule_248580__etc_sysctl_d_99_sysctl_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248580_Manage
# R-248586 OL08-00-010390
- name: stigrule_248586_esc
  yum:
    name: esc
    state: "{{ ol8STIG_stigrule_248586_esc_State }}"
  when: ol8STIG_stigrule_248586_Manage
# R-248586 OL08-00-010390
- name: stigrule_248586_openssl_pkcs11
  yum:
    name: openssl-pkcs11
    state: "{{ ol8STIG_stigrule_248586_openssl_pkcs11_State }}"
  when: ol8STIG_stigrule_248586_Manage
# R-248588 OL08-00-010410
- name: stigrule_248588_opensc
  yum:
    name: opensc
    state: "{{ ol8STIG_stigrule_248588_opensc_State }}"
  when: ol8STIG_stigrule_248588_Manage
# R-248594 OL08-00-010430
- name: stigrule_248594__etc_sysctl_d_99_sysctl_conf
  lineinfile:
    path: /etc/sysctl.d/99-sysctl.conf
    regexp: '^kernel.randomize_va_space = '
    line: "{{ ol8STIG_stigrule_248594__etc_sysctl_d_99_sysctl_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248594_Manage
# R-248595 OL08-00-010440
- name: stigrule_248595__etc_dnf_dnf_conf
  ini_file:
    path: /etc/dnf/dnf.conf
    section: main
    option: clean_requirements_on_remove
    value: "{{ ol8STIG_stigrule_248595__etc_dnf_dnf_conf_Value }}"
    no_extra_spaces: yes
  when:
    - ol8STIG_stigrule_248595_Manage
# R-248596 OL08-00-010450
- name: stigrule_248596__etc_selinux_config
  lineinfile:
    path: /etc/selinux/config
    regexp: '^SELINUXTYPE='
    line: "{{ ol8STIG_stigrule_248596__etc_selinux_config_Line }}"
    create: yes
  notify: do_reboot
  when:
    - ol8STIG_stigrule_248596_Manage
# R-248599 OL08-00-010473
- name: check if rngd.service is installed
  shell: ! systemctl list-unit-files | grep "^rngd.service[ \t]\+"
  changed_when: False
  check_mode: no
  register: result
  failed_when: result.rc > 1
- name: stigrule_248599_rngd_enable
  service:
    name: rngd.service
    enabled: "{{ ol8STIG_stigrule_248599_rngd_enable_Enabled }}"
  when:
    - ol8STIG_stigrule_248599_Manage
    - result.rc == 0
# R-248599 OL08-00-010473
- name: check if rngd.service is installed
  shell: ! systemctl list-unit-files | grep "^rngd.service[ \t]\+"
  changed_when: False
  check_mode: no
  register: result
  failed_when: result.rc > 1
- name: stigrule_248599_rngd_start
  service:
    name: rngd.service
    state: "{{ ol8STIG_stigrule_248599_rngd_start_State }}"
  when:
    - ol8STIG_stigrule_248599_Manage
    - result.rc == 0
# R-248600 OL08-00-010472
- name: stigrule_248600_rng_tools
  yum:
    name: rng-tools
    state: "{{ ol8STIG_stigrule_248600_rng_tools_State }}"
  when: ol8STIG_stigrule_248600_Manage
# R-248603 OL08-00-010500
- name: stigrule_248603_StrictModes
  lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '(?i)^\s*StrictModes\s+'
    line: "{{ ol8STIG_stigrule_248603_StrictModes_Line }}"
  notify: ssh_restart
  when:
    - ol8STIG_stigrule_248603_Manage
    - "'openssh-server' in packages"
# R-248605 OL08-00-010520
- name: stigrule_248605_IgnoreUserKnownHosts
  lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '(?i)^\s*IgnoreUserKnownHosts\s+'
    line: "{{ ol8STIG_stigrule_248605_IgnoreUserKnownHosts_Line }}"
  notify: ssh_restart
  when:
    - ol8STIG_stigrule_248605_Manage
    - "'openssh-server' in packages"
# R-248606 OL08-00-010521
- name: stigrule_248606_KerberosAuthentication
  lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '(?i)^\s*KerberosAuthentication\s+'
    line: "{{ ol8STIG_stigrule_248606_KerberosAuthentication_Line }}"
  notify: ssh_restart
  when:
    - ol8STIG_stigrule_248606_Manage
    - "'openssh-server' in packages"
# R-248607 OL08-00-010522
- name: stigrule_248607_GSSAPIAuthentication
  lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '(?i)^\s*GSSAPIAuthentication\s+'
    line: "{{ ol8STIG_stigrule_248607_GSSAPIAuthentication_Line }}"
  notify: ssh_restart
  when:
    - ol8STIG_stigrule_248607_Manage
    - "'openssh-server' in packages"
# R-248613 OL08-00-010550
- name: stigrule_248613_PermitRootLogin
  lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '(?i)^\s*PermitRootLogin\s+'
    line: "{{ ol8STIG_stigrule_248613_PermitRootLogin_Line }}"
  notify: ssh_restart
  when:
    - ol8STIG_stigrule_248613_Manage
    - "'openssh-server' in packages"
# R-248615 OL08-00-010561
- name: check if rsyslog.service is installed
  shell: ! systemctl list-unit-files | grep "^rsyslog.service[ \t]\+"
  changed_when: False
  check_mode: no
  register: result
  failed_when: result.rc > 1
- name: stigrule_248615_rsyslog_enable
  service:
    name: rsyslog.service
    enabled: "{{ ol8STIG_stigrule_248615_rsyslog_enable_Enabled }}"
  when:
    - ol8STIG_stigrule_248615_Manage
    - result.rc == 0
# R-248615 OL08-00-010561
- name: check if rsyslog.service is installed
  shell: ! systemctl list-unit-files | grep "^rsyslog.service[ \t]\+"
  changed_when: False
  check_mode: no
  register: result
  failed_when: result.rc > 1
- name: stigrule_248615_rsyslog_start
  service:
    name: rsyslog.service
    state: "{{ ol8STIG_stigrule_248615_rsyslog_start_State }}"
  when:
    - ol8STIG_stigrule_248615_Manage
    - result.rc == 0
# R-248628 OL08-00-010670
# If kernel core dumps are required, document the need with the ISSO.
- name: check if kdump.service is installed
  shell: ! systemctl list-unit-files | grep "^kdump.service[ \t]\+"
  changed_when: False
  check_mode: no
  register: result
  failed_when: result.rc > 1
- name: stigrule_248628_kdump_disable
  service:
    name: kdump.service
    enabled: "{{ ol8STIG_stigrule_248628_kdump_disable_Enabled }}"
  when:
    - ol8STIG_stigrule_248628_Manage
    - result.rc == 0
# R-248629 OL08-00-010671
- name: stigrule_248629__etc_sysctl_d_99_sysctl_conf
  lineinfile:
    path: /etc/sysctl.d/99-sysctl.conf
    regexp: 'kernel.core_pattern='
    line: "{{ ol8STIG_stigrule_248629__etc_sysctl_d_99_sysctl_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248629_Manage
# R-248629 OL08-00-010671
- name: stigrule_248629_kernel_core_pattern
  sysctl:
    name: kernel.core_pattern
    value: "{{ ol8STIG_stigrule_248629_kernel_core_pattern_Value }}"
  when:
    - ol8STIG_stigrule_248629_Manage
# R-248631 OL08-00-010673
- name: stigrule_248631__etc_security_limits_conf
  lineinfile:
    path: /etc/security/limits.conf
    regexp: '^\* hard core'
    line: "{{ ol8STIG_stigrule_248631__etc_security_limits_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248631_Manage
# R-248632 OL08-00-010674
- name: stigrule_248632__etc_systemd_coredump_conf
  lineinfile:
    path: /etc/systemd/coredump.conf
    regexp: '^Storage='
    line: "{{ ol8STIG_stigrule_248632__etc_systemd_coredump_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248632_Manage
# R-248633 OL08-00-010675
- name: stigrule_248633__etc_systemd_coredump_conf
  lineinfile:
    path: /etc/systemd/coredump.conf
    regexp: '^ProcessSizeMax='
    line: "{{ ol8STIG_stigrule_248633__etc_systemd_coredump_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248633_Manage
# R-248649 OL08-00-010820
- name: stigrule_248649__etc_gdm_custom_conf
  ini_file:
    path: /etc/gdm/custom.conf
    section: daemon
    option: AutomaticLoginEnable
    value: "{{ ol8STIG_stigrule_248649__etc_gdm_custom_conf_Value }}"
    no_extra_spaces: yes
  when:
    - ol8STIG_stigrule_248649_Manage
    - "'gdm' in packages"
# R-248650 OL08-00-010830
- name: stigrule_248650_PermitUserEnvironment
  lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '(?i)^\s*PermitUserEnvironment\s+'
    line: "{{ ol8STIG_stigrule_248650_PermitUserEnvironment_Line }}"
  notify: ssh_restart
  when:
    - ol8STIG_stigrule_248650_Manage
    - "'openssh-server' in packages"
# R-248655 OL08-00-020013
- name: stigrule_248655__etc_security_faillock_conf
  lineinfile:
    path: /etc/security/faillock.conf
    regexp: '^\* fail_interval'
    line: "{{ ol8STIG_stigrule_248655__etc_security_faillock_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248655_Manage
# R-248665 OL08-00-020023
- name: stigrule_248665__etc_security_faillock_conf
  lineinfile:
    path: /etc/security/faillock.conf
    line: "{{ ol8STIG_stigrule_248665__etc_security_faillock_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248665_Manage
# R-248666 OL08-00-020024
- name: stigrule_248666__etc_security_limits_conf
  lineinfile:
    path: /etc/security/limits.conf
    regexp: '^\* hard maxlogins'
    line: "{{ ol8STIG_stigrule_248666__etc_security_limits_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248666_Manage
# R-248667 OL08-00-020025
- name: stigrule_248667_ensure_openssh_server_x86_64_is_installed
  yum:
    name: openssh-server.x86_64
    state: "{{ ol8STIG_stigrule_248667_ensure_openssh_server_x86_64_is_installed_State }}"
  when: ol8STIG_stigrule_248667_Manage
# R-248667 OL08-00-020025
- name: check if sshd.service is installed
  shell: ! systemctl list-unit-files | grep "^sshd.service[ \t]\+"
  changed_when: False
  check_mode: no
  register: result
  failed_when: result.rc > 1
- name: stigrule_248667_sshd_enable
  service:
    name: sshd.service
    enabled: "{{ ol8STIG_stigrule_248667_sshd_enable_Enabled }}"
  when:
    - ol8STIG_stigrule_248667_Manage
    - result.rc == 0
# R-248671 OL08-00-020030
- name: stigrule_248671__etc_dconf_db_local_d_00_screensaver
  ini_file:
    path: /etc/dconf/db/local.d/00-screensaver
    section: org/gnome/desktop/screensaver
    option: lock-enabled
    value: "{{ ol8STIG_stigrule_248671__etc_dconf_db_local_d_00_screensaver_Value }}"
    no_extra_spaces: yes
  notify: dconf_update
  when:
    - ol8STIG_stigrule_248671_Manage
    - "'dconf' in packages"
# R-248672 OL08-00-020031
- name: stigrule_248672__etc_dconf_db_local_d_00_screensaver
  ini_file:
    path: /etc/dconf/db/local.d/00-screensaver
    section: org/gnome/desktop/screensaver
    option: lock-delay
    value: "{{ ol8STIG_stigrule_248672__etc_dconf_db_local_d_00_screensaver_Value }}"
    no_extra_spaces: yes
  notify: dconf_update
  when:
    - ol8STIG_stigrule_248672_Manage
    - "'dconf' in packages"
# R-248673 OL08-00-020032
- name: stigrule_248673__etc_dconf_db_local_d_02_login_screen
  ini_file:
    path: /etc/dconf/db/local.d/02-login-screen
    section: org/gnome/login-screen
    option: disable-user-list
    value: "{{ ol8STIG_stigrule_248673__etc_dconf_db_local_d_02_login_screen_Value }}"
    no_extra_spaces: yes
  notify: dconf_update
  when:
    - ol8STIG_stigrule_248673_Manage
    - "'dconf' in packages"
# R-248680 OL08-00-020060
- name: stigrule_248680__etc_dconf_db_local_d_00_screensaver
  ini_file:
    path: /etc/dconf/db/local.d/00-screensaver
    section: org/gnome/desktop/session
    option: idle-delay
    value: "{{ ol8STIG_stigrule_248680__etc_dconf_db_local_d_00_screensaver_Value }}"
    no_extra_spaces: yes
  notify: dconf_update
  when:
    - ol8STIG_stigrule_248680_Manage
    - "'dconf' in packages"
# R-248682 OL08-00-020080
- name: stigrule_248682__etc_dconf_db_local_d_locks_session_lock_delay
  lineinfile:
    path: /etc/dconf/db/local.d/locks/session lock-delay
    line: "{{ ol8STIG_stigrule_248682__etc_dconf_db_local_d_locks_session_lock_delay_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248682_Manage
# R-248683 OL08-00-020081
- name: stigrule_248683__etc_dconf_db_local_d_locks_session_idle_delay
  lineinfile:
    path: /etc/dconf/db/local.d/locks/session idle-delay
    line: "{{ ol8STIG_stigrule_248683__etc_dconf_db_local_d_locks_session_idle_delay_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248683_Manage
# R-248684 OL08-00-020082
- name: stigrule_248684__etc_dconf_db_local_d_locks_session_lock_enabled
  lineinfile:
    path: /etc/dconf/db/local.d/locks/session lock-enabled
    line: "{{ ol8STIG_stigrule_248684__etc_dconf_db_local_d_locks_session_lock_enabled_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248684_Manage
# R-248687 OL08-00-020110
- name: stigrule_248687__etc_security_pwquality_conf
  lineinfile:
    path: /etc/security/pwquality.conf
    regexp: '^\s*ucredit'
    line: "{{ ol8STIG_stigrule_248687__etc_security_pwquality_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248687_Manage
# R-248688 OL08-00-020120
- name: stigrule_248688__etc_security_pwquality_conf
  lineinfile:
    path: /etc/security/pwquality.conf
    regexp: '^\s*lcredit'
    line: "{{ ol8STIG_stigrule_248688__etc_security_pwquality_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248688_Manage
# R-248689 OL08-00-020130
- name: stigrule_248689__etc_security_pwquality_conf
  lineinfile:
    path: /etc/security/pwquality.conf
    regexp: '^\s*dcredit'
    line: "{{ ol8STIG_stigrule_248689__etc_security_pwquality_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248689_Manage
# R-248690 OL08-00-020140
- name: stigrule_248690__etc_security_pwquality_conf
  lineinfile:
    path: /etc/security/pwquality.conf
    regexp: '^\s*maxclassrepeat'
    line: "{{ ol8STIG_stigrule_248690__etc_security_pwquality_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248690_Manage
# R-248691 OL08-00-020150
- name: stigrule_248691__etc_security_pwquality_conf
  lineinfile:
    path: /etc/security/pwquality.conf
    regexp: '^\s*maxrepeat'
    line: "{{ ol8STIG_stigrule_248691__etc_security_pwquality_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248691_Manage
# R-248692 OL08-00-020160
- name: stigrule_248692__etc_security_pwquality_conf
  lineinfile:
    path: /etc/security/pwquality.conf
    regexp: '^\s*minclass'
    line: "{{ ol8STIG_stigrule_248692__etc_security_pwquality_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248692_Manage
# R-248693 OL08-00-020170
- name: stigrule_248693__etc_security_pwquality_conf
  lineinfile:
    path: /etc/security/pwquality.conf
    regexp: '^\s*difok'
    line: "{{ ol8STIG_stigrule_248693__etc_security_pwquality_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248693_Manage
# R-248695 OL08-00-020190
- name: stigrule_248695__etc_login_defs
  lineinfile:
    path: /etc/login.defs
    regexp: '^PASS_MIN_DAYS'
    line: "{{ ol8STIG_stigrule_248695__etc_login_defs_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248695_Manage
# R-248696 OL08-00-020200
- name: stigrule_248696__etc_login_defs
  lineinfile:
    path: /etc/login.defs
    regexp: '^PASS_MAX_DAYS'
    line: "{{ ol8STIG_stigrule_248696__etc_login_defs_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248696_Manage
# R-248699 OL08-00-020230
- name: stigrule_248699__etc_security_pwquality_conf
  lineinfile:
    path: /etc/security/pwquality.conf
    regexp: '^\s*minlen'
    line: "{{ ol8STIG_stigrule_248699__etc_security_pwquality_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248699_Manage
# R-248700 OL08-00-020231
- name: stigrule_248700__etc_login_defs
  lineinfile:
    path: /etc/login.defs
    regexp: '^PASS_MIN_LEN'
    line: "{{ ol8STIG_stigrule_248700__etc_login_defs_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248700_Manage
# R-248709 OL08-00-020280
- name: stigrule_248709__etc_security_pwquality_conf
  lineinfile:
    path: /etc/security/pwquality.conf
    regexp: '^\s*ocredit'
    line: "{{ ol8STIG_stigrule_248709__etc_security_pwquality_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248709_Manage
# R-248711 OL08-00-020300
- name: stigrule_248711__etc_security_pwquality_conf
  lineinfile:
    path: /etc/security/pwquality.conf
    regexp: '^\s*dictcheck'
    line: "{{ ol8STIG_stigrule_248711__etc_security_pwquality_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248711_Manage
# R-248712 OL08-00-020310
- name: stigrule_248712__etc_login_defs
  lineinfile:
    path: /etc/login.defs
    regexp: '^FAIL_DELAY'
    line: "{{ ol8STIG_stigrule_248712__etc_login_defs_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248712_Manage
# R-248714 OL08-00-020330
- name: stigrule_248714_PermitEmptyPasswords
  lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '(?i)^\s*PermitEmptyPasswords\s+'
    line: "{{ ol8STIG_stigrule_248714_PermitEmptyPasswords_Line }}"
  notify: ssh_restart
  when:
    - ol8STIG_stigrule_248714_Manage
    - "'openssh-server' in packages"
# R-248718 OL08-00-020350
- name: stigrule_248718_PrintLastLog
  lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '(?i)^\s*PrintLastLog\s+'
    line: "{{ ol8STIG_stigrule_248718_PrintLastLog_Line }}"
  notify: ssh_restart
  when:
    - ol8STIG_stigrule_248718_Manage
    - "'openssh-server' in packages"
# R-248719 OL08-00-020351
- name: stigrule_248719__etc_login_defs
  lineinfile:
    path: /etc/login.defs
    regexp: '^UMASK'
    line: "{{ ol8STIG_stigrule_248719__etc_login_defs_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248719_Manage
# R-248722 OL08-00-030000
- name: stigrule_248722__etc_audit_rules_d_audit_rules_execve_euid_b32
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b32 -S execve -C uid!=euid -F key=execpriv$'
    line: "{{ ol8STIG_stigrule_248722__etc_audit_rules_d_audit_rules_execve_euid_b32_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248722_Manage
# R-248722 OL08-00-030000
- name: stigrule_248722__etc_audit_rules_d_audit_rules_execve_euid_b64
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b64 -S execve -C uid!=euid -F key=execpriv $'
    line: "{{ ol8STIG_stigrule_248722__etc_audit_rules_d_audit_rules_execve_euid_b64_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248722_Manage
# R-248722 OL08-00-030000
- name: stigrule_248722__etc_audit_rules_d_audit_rules_execve_egid_b32
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b32 -S execve -C gid!=egid -F key=execpriv$'
    line: "{{ ol8STIG_stigrule_248722__etc_audit_rules_d_audit_rules_execve_egid_b32_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248722_Manage
# R-248722 OL08-00-030000
- name: stigrule_248722__etc_audit_rules_d_audit_rules_execve_egid_b64
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b64 -S execve -C gid!=egid -F key=execpriv$'
    line: "{{ ol8STIG_stigrule_248722__etc_audit_rules_d_audit_rules_execve_egid_b64_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248722_Manage
# R-248723 OL08-00-030010
- name: stigrule_248723__etc_rsyslog_conf
  lineinfile:
    path: /etc/rsyslog.conf
    line: "{{ ol8STIG_stigrule_248723__etc_rsyslog_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248723_Manage
# R-248724 OL08-00-030020
- name: stigrule_248724__etc_audit_auditd_conf
  lineinfile:
    path: /etc/audit/auditd.conf
    regexp: '^action_mail_acct = '
    line: "{{ ol8STIG_stigrule_248724__etc_audit_auditd_conf_Line }}"
    create: yes
  notify: auditd_restart
  when:
    - ol8STIG_stigrule_248724_Manage
# R-248725 OL08-00-030030
- name: stigrule_248725__etc_aliases
  lineinfile:
    path: /etc/aliases
    regexp: '^postmaster:'
    line: "{{ ol8STIG_stigrule_248725__etc_aliases_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248725_Manage
# R-248726 OL08-00-030040
- name: stigrule_248726__etc_audit_auditd_conf
  lineinfile:
    path: /etc/audit/auditd.conf
    regexp: '^disk_error_action = '
    line: "{{ ol8STIG_stigrule_248726__etc_audit_auditd_conf_Line }}"
    create: yes
  notify: auditd_restart
  when:
    - ol8STIG_stigrule_248726_Manage
# R-248728 OL08-00-030060
- name: stigrule_248728__etc_audit_auditd_conf
  lineinfile:
    path: /etc/audit/auditd.conf
    regexp: '^disk_full_action = '
    line: "{{ ol8STIG_stigrule_248728__etc_audit_auditd_conf_Line }}"
    create: yes
  notify: auditd_restart
  when:
    - ol8STIG_stigrule_248728_Manage
# R-248729 OL08-00-030061
- name: stigrule_248729__etc_audit_auditd_conf
  lineinfile:
    path: /etc/audit/auditd.conf
    regexp: '^local_events = '
    line: "{{ ol8STIG_stigrule_248729__etc_audit_auditd_conf_Line }}"
    create: yes
  notify: auditd_restart
  when:
    - ol8STIG_stigrule_248729_Manage
# R-248730 OL08-00-030062
- name: stigrule_248730__etc_audit_auditd_conf
  lineinfile:
    path: /etc/audit/auditd.conf
    regexp: '^name_format = '
    line: "{{ ol8STIG_stigrule_248730__etc_audit_auditd_conf_Line }}"
    create: yes
  notify: auditd_restart
  when:
    - ol8STIG_stigrule_248730_Manage
# R-248731 OL08-00-030063
- name: stigrule_248731__etc_audit_auditd_conf
  lineinfile:
    path: /etc/audit/auditd.conf
    regexp: '^log_format = '
    line: "{{ ol8STIG_stigrule_248731__etc_audit_auditd_conf_Line }}"
    create: yes
  notify: auditd_restart
  when:
    - ol8STIG_stigrule_248731_Manage
# R-248732 OL08-00-030070
- name: stigrule_248732__etc_audit_auditd_conf
  lineinfile:
    path: /etc/audit/auditd.conf
    regexp: '^log_group = '
    line: "{{ ol8STIG_stigrule_248732__etc_audit_auditd_conf_Line }}"
    create: yes
  notify: auditd_restart
  when:
    - ol8STIG_stigrule_248732_Manage
# R-248738 OL08-00-030121
- name: stigrule_248738__etc_audit_rules_d_audit_rules_e2
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-e 2$'
    line: "{{ ol8STIG_stigrule_248738__etc_audit_rules_d_audit_rules_e2_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248738_Manage
# R-248739 OL08-00-030122
- name: stigrule_248739__etc_audit_rules_d_audit_rules_loginuid_immutable
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^--loginuid-immutable$'
    line: "{{ ol8STIG_stigrule_248739__etc_audit_rules_d_audit_rules_loginuid_immutable_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248739_Manage
# R-248740 OL08-00-030130
- name: stigrule_248740__etc_audit_rules_d_audit_rules__etc_shadow
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-w /etc/shadow -p wa -k identity$'
    line: "{{ ol8STIG_stigrule_248740__etc_audit_rules_d_audit_rules__etc_shadow_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248740_Manage
# R-248741 OL08-00-030140
- name: stigrule_248741__etc_audit_rules_d_audit_rules__etc_security_opasswd
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-w /etc/security/opasswd -p wa -k identity$'
    line: "{{ ol8STIG_stigrule_248741__etc_audit_rules_d_audit_rules__etc_security_opasswd_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248741_Manage
# R-248742 OL08-00-030150
- name: stigrule_248742__etc_audit_rules_d_audit_rules__etc_passwd
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-w /etc/passwd -p wa -k identity$'
    line: "{{ ol8STIG_stigrule_248742__etc_audit_rules_d_audit_rules__etc_passwd_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248742_Manage
# R-248743 OL08-00-030160
- name: stigrule_248743__etc_audit_rules_d_audit_rules__etc_gshadow
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-w /etc/gshadow -p wa -k identity$'
    line: "{{ ol8STIG_stigrule_248743__etc_audit_rules_d_audit_rules__etc_gshadow_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248743_Manage
# R-248744 OL08-00-030170
- name: stigrule_248744__etc_audit_rules_d_audit_rules__etc_group
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-w /etc/group -p wa -k identity$'
    line: "{{ ol8STIG_stigrule_248744__etc_audit_rules_d_audit_rules__etc_group_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248744_Manage
# R-248745 OL08-00-030171
- name: stigrule_248745__etc_audit_rules_d_audit_rules__etc_sudoers
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-w /etc/sudoers -p wa -k identity$'
    line: "{{ ol8STIG_stigrule_248745__etc_audit_rules_d_audit_rules__etc_sudoers_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248745_Manage
# R-248746 OL08-00-030172
- name: stigrule_248746__etc_audit_rules_d_audit_rules__etc_sudoers_d_
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-w /etc/sudoers.d/ -p wa -k identity$'
    line: "{{ ol8STIG_stigrule_248746__etc_audit_rules_d_audit_rules__etc_sudoers_d__Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248746_Manage
# R-248747 OL08-00-030190
- name: stigrule_248747__etc_audit_rules_d_audit_rules__usr_bin_su
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=unset -k privileged-priv_change$'
    line: "{{ ol8STIG_stigrule_248747__etc_audit_rules_d_audit_rules__usr_bin_su_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248747_Manage
# R-248748 OL08-00-030200
- name: stigrule_248748__etc_audit_rules_d_audit_rules_lremovexattr_b32_unset
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b32 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid>=1000 -F auid!=unset -k perm_mod$'
    line: "{{ ol8STIG_stigrule_248748__etc_audit_rules_d_audit_rules_lremovexattr_b32_unset_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248748_Manage
# R-248748 OL08-00-030200
- name: stigrule_248748__etc_audit_rules_d_audit_rules_lremovexattr_b64_unset
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b64 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid>=1000 -F auid!=unset -k perm_mod$'
    line: "{{ ol8STIG_stigrule_248748__etc_audit_rules_d_audit_rules_lremovexattr_b64_unset_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248748_Manage
# R-248748 OL08-00-030200
- name: stigrule_248748__etc_audit_rules_d_audit_rules_lremovexattr_b32
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b32 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid=0 -k perm_mod$'
    line: "{{ ol8STIG_stigrule_248748__etc_audit_rules_d_audit_rules_lremovexattr_b32_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248748_Manage
# R-248748 OL08-00-030200
- name: stigrule_248748__etc_audit_rules_d_audit_rules_lremovexattr_b64
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b64 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid=0 -k perm_mod$'
    line: "{{ ol8STIG_stigrule_248748__etc_audit_rules_d_audit_rules_lremovexattr_b64_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248748_Manage
# R-248753 OL08-00-030250
- name: stigrule_248753__etc_audit_rules_d_audit_rules__usr_bin_chage
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=unset -k privileged-chage$'
    line: "{{ ol8STIG_stigrule_248753__etc_audit_rules_d_audit_rules__usr_bin_chage_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248753_Manage
# R-248754 OL08-00-030260
- name: stigrule_248754__etc_audit_rules_d_audit_rules__usr_bin_chcon
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=unset -k perm_mod$'
    line: "{{ ol8STIG_stigrule_248754__etc_audit_rules_d_audit_rules__usr_bin_chcon_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248754_Manage
# R-248756 OL08-00-030280
- name: stigrule_248756__etc_audit_rules_d_audit_rules__usr_bin_ssh_agent
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/bin/ssh-agent -F perm=x -F auid>=1000 -F auid!=unset -k privileged-ssh$'
    line: "{{ ol8STIG_stigrule_248756__etc_audit_rules_d_audit_rules__usr_bin_ssh_agent_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248756_Manage
# R-248757 OL08-00-030290
- name: stigrule_248757__etc_audit_rules_d_audit_rules__usr_bin_passwd
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/bin/passwd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-passwd$'
    line: "{{ ol8STIG_stigrule_248757__etc_audit_rules_d_audit_rules__usr_bin_passwd_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248757_Manage
# R-248758 OL08-00-030300
- name: stigrule_248758__etc_audit_rules_d_audit_rules__usr_bin_mount
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=unset -k privileged-mount$'
    line: "{{ ol8STIG_stigrule_248758__etc_audit_rules_d_audit_rules__usr_bin_mount_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248758_Manage
# R-248759 OL08-00-030301
- name: stigrule_248759__etc_audit_rules_d_audit_rules__usr_bin_umount
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=unset -k privileged-mount$'
    line: "{{ ol8STIG_stigrule_248759__etc_audit_rules_d_audit_rules__usr_bin_umount_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248759_Manage
# R-248760 OL08-00-030302
- name: stigrule_248760__etc_audit_rules_d_audit_rules_mount_b32
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=unset -k privileged-mount$'
    line: "{{ ol8STIG_stigrule_248760__etc_audit_rules_d_audit_rules_mount_b32_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248760_Manage
# R-248760 OL08-00-030302
- name: stigrule_248760__etc_audit_rules_d_audit_rules_mount_b64
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=unset -k privileged-mount$'
    line: "{{ ol8STIG_stigrule_248760__etc_audit_rules_d_audit_rules_mount_b64_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248760_Manage
# R-248761 OL08-00-030310
- name: stigrule_248761__etc_audit_rules_d_audit_rules__usr_sbin_unix_update
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/sbin/unix_update -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update$'
    line: "{{ ol8STIG_stigrule_248761__etc_audit_rules_d_audit_rules__usr_sbin_unix_update_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248761_Manage
# R-248762 OL08-00-030311
- name: stigrule_248762__etc_audit_rules_d_audit_rules__usr_sbin_postdrop
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/sbin/postdrop -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update$'
    line: "{{ ol8STIG_stigrule_248762__etc_audit_rules_d_audit_rules__usr_sbin_postdrop_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248762_Manage
# R-248763 OL08-00-030312
- name: stigrule_248763__etc_audit_rules_d_audit_rules__usr_sbin_postqueue
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/sbin/postqueue -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update$'
    line: "{{ ol8STIG_stigrule_248763__etc_audit_rules_d_audit_rules__usr_sbin_postqueue_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248763_Manage
# R-248764 OL08-00-030313
- name: stigrule_248764__etc_audit_rules_d_audit_rules__usr_sbin_semanage
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update$'
    line: "{{ ol8STIG_stigrule_248764__etc_audit_rules_d_audit_rules__usr_sbin_semanage_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248764_Manage
# R-248765 OL08-00-030314
- name: stigrule_248765__etc_audit_rules_d_audit_rules__usr_sbin_setfiles
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update$'
    line: "{{ ol8STIG_stigrule_248765__etc_audit_rules_d_audit_rules__usr_sbin_setfiles_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248765_Manage
# R-248766 OL08-00-030315
- name: stigrule_248766__etc_audit_rules_d_audit_rules__usr_sbin_userhelper
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update$'
    line: "{{ ol8STIG_stigrule_248766__etc_audit_rules_d_audit_rules__usr_sbin_userhelper_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248766_Manage
# R-248767 OL08-00-030316
- name: stigrule_248767__etc_audit_rules_d_audit_rules__usr_sbin_setsebool
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update$'
    line: "{{ ol8STIG_stigrule_248767__etc_audit_rules_d_audit_rules__usr_sbin_setsebool_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248767_Manage
# R-248768 OL08-00-030317
- name: stigrule_248768__etc_audit_rules_d_audit_rules__usr_sbin_unix_chkpwd
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update$'
    line: "{{ ol8STIG_stigrule_248768__etc_audit_rules_d_audit_rules__usr_sbin_unix_chkpwd_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248768_Manage
# R-248769 OL08-00-030320
- name: stigrule_248769__etc_audit_rules_d_audit_rules__usr_libexec_openssh_ssh_keysign
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F perm=x -F auid>=1000 -F auid!=unset -k privileged-ssh$'
    line: "{{ ol8STIG_stigrule_248769__etc_audit_rules_d_audit_rules__usr_libexec_openssh_ssh_keysign_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248769_Manage
# R-248770 OL08-00-030330
- name: stigrule_248770__etc_audit_rules_d_audit_rules__usr_bin_setfacl
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/bin/setfacl -F perm=x -F auid>=1000 -F auid!=unset -k perm_mod$'
    line: "{{ ol8STIG_stigrule_248770__etc_audit_rules_d_audit_rules__usr_bin_setfacl_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248770_Manage
# R-248771 OL08-00-030340
- name: stigrule_248771__etc_audit_rules_d_audit_rules__usr_sbin_pam_timestamp_check
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid>=1000 -F auid!=unset -k privileged-pam_timestamp_check$'
    line: "{{ ol8STIG_stigrule_248771__etc_audit_rules_d_audit_rules__usr_sbin_pam_timestamp_check_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248771_Manage
# R-248772 OL08-00-030350
- name: stigrule_248772__etc_audit_rules_d_audit_rules__usr_bin_newgrp
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd$'
    line: "{{ ol8STIG_stigrule_248772__etc_audit_rules_d_audit_rules__usr_bin_newgrp_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248772_Manage
# R-248773 OL08-00-030360
- name: stigrule_248773__etc_audit_rules_d_audit_rules_init_module_b32
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b32 -S init_module,finit_module -F auid>=1000 -F auid!=unset -k module_chng$'
    line: "{{ ol8STIG_stigrule_248773__etc_audit_rules_d_audit_rules_init_module_b32_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248773_Manage
# R-248773 OL08-00-030360
- name: stigrule_248773__etc_audit_rules_d_audit_rules_init_module_b64
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b64 -S init_module,finit_module -F auid>=1000 -F auid!=unset -k module_chng$'
    line: "{{ ol8STIG_stigrule_248773__etc_audit_rules_d_audit_rules_init_module_b64_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248773_Manage
# R-248774 OL08-00-030361
- name: stigrule_248774__etc_audit_rules_d_audit_rules_rename_b32
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b32 -S rename,unlink,rmdir,renameat,unlinkat -F success=1 -F auid>=1000 -F auid!=unset -k delete$'
    line: "{{ ol8STIG_stigrule_248774__etc_audit_rules_d_audit_rules_rename_b32_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248774_Manage
# R-248774 OL08-00-030361
- name: stigrule_248774__etc_audit_rules_d_audit_rules_rename_b64
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b64 -S rename,unlink,rmdir,renameat,unlinkat -F success=1 -F auid>=1000 -F auid!=unset -k delete$'
    line: "{{ ol8STIG_stigrule_248774__etc_audit_rules_d_audit_rules_rename_b64_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248774_Manage
# R-248779 OL08-00-030370
- name: stigrule_248779__etc_audit_rules_d_audit_rules__usr_bin_gpasswd
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-gpasswd$'
    line: "{{ ol8STIG_stigrule_248779__etc_audit_rules_d_audit_rules__usr_bin_gpasswd_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248779_Manage
# R-248781 OL08-00-030390
- name: stigrule_248781__etc_audit_rules_d_audit_rules_delete_module_b32
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b32 -S delete_module -F auid>=1000 -F auid!=unset -k module_chng$'
    line: "{{ ol8STIG_stigrule_248781__etc_audit_rules_d_audit_rules_delete_module_b32_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248781_Manage
# R-248781 OL08-00-030390
- name: stigrule_248781__etc_audit_rules_d_audit_rules_delete_module_b64
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b64 -S delete_module -F auid>=1000 -F auid!=unset -k module_chng$'
    line: "{{ ol8STIG_stigrule_248781__etc_audit_rules_d_audit_rules_delete_module_b64_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248781_Manage
# R-248782 OL08-00-030400
- name: stigrule_248782__etc_audit_rules_d_audit_rules__usr_bin_crontab
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/bin/crontab -F perm=x -F auid>=1000 -F auid!=unset -k privileged-crontab$'
    line: "{{ ol8STIG_stigrule_248782__etc_audit_rules_d_audit_rules__usr_bin_crontab_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248782_Manage
# R-248783 OL08-00-030410
- name: stigrule_248783__etc_audit_rules_d_audit_rules__usr_bin_chsh
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd$'
    line: "{{ ol8STIG_stigrule_248783__etc_audit_rules_d_audit_rules__usr_bin_chsh_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248783_Manage
# R-248784 OL08-00-030420
- name: stigrule_248784__etc_audit_rules_d_audit_rules_truncate_EPERM_b32
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b32 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -k perm_access$'
    line: "{{ ol8STIG_stigrule_248784__etc_audit_rules_d_audit_rules_truncate_EPERM_b32_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248784_Manage
# R-248784 OL08-00-030420
- name: stigrule_248784__etc_audit_rules_d_audit_rules_truncate_EPERM_b64
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b64 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -k perm_access$'
    line: "{{ ol8STIG_stigrule_248784__etc_audit_rules_d_audit_rules_truncate_EPERM_b64_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248784_Manage
# R-248784 OL08-00-030420
- name: stigrule_248784__etc_audit_rules_d_audit_rules_truncate_EACCES_b32
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b32 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -k perm_access$'
    line: "{{ ol8STIG_stigrule_248784__etc_audit_rules_d_audit_rules_truncate_EACCES_b32_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248784_Manage
# R-248784 OL08-00-030420
- name: stigrule_248784__etc_audit_rules_d_audit_rules_truncate_EACCES_b64
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b64 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -k perm_access$'
    line: "{{ ol8STIG_stigrule_248784__etc_audit_rules_d_audit_rules_truncate_EACCES_b64_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248784_Manage
# R-248790 OL08-00-030480
- name: stigrule_248790__etc_audit_rules_d_audit_rules_chown_b32
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b32 -S chown,fchown,fchownat,lchown -F auid>=1000 -F auid!=unset -k perm_mod$'
    line: "{{ ol8STIG_stigrule_248790__etc_audit_rules_d_audit_rules_chown_b32_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248790_Manage
# R-248790 OL08-00-030480
- name: stigrule_248790__etc_audit_rules_d_audit_rules_chown_b64
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b64 -S chown,fchown,fchownat,lchown -F auid>=1000 -F auid!=unset -k perm_mod$'
    line: "{{ ol8STIG_stigrule_248790__etc_audit_rules_d_audit_rules_chown_b64_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248790_Manage
# R-248791 OL08-00-030490
- name: stigrule_248791__etc_audit_rules_d_audit_rules_chmod_b32
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid>=1000 -F auid!=unset -k perm_mod$'
    line: "{{ ol8STIG_stigrule_248791__etc_audit_rules_d_audit_rules_chmod_b32_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248791_Manage
# R-248791 OL08-00-030490
- name: stigrule_248791__etc_audit_rules_d_audit_rules_chmod_b64
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid>=1000 -F auid!=unset -k perm_mod$'
    line: "{{ ol8STIG_stigrule_248791__etc_audit_rules_d_audit_rules_chmod_b64_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248791_Manage
# R-248797 OL08-00-030550
- name: stigrule_248797__etc_audit_rules_d_audit_rules__usr_bin_sudo
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd$'
    line: "{{ ol8STIG_stigrule_248797__etc_audit_rules_d_audit_rules__usr_bin_sudo_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248797_Manage
# R-248798 OL08-00-030560
- name: stigrule_248798__etc_audit_rules_d_audit_rules__usr_sbin_usermod
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/sbin/usermod -F perm=x -F auid>=1000 -F auid!=unset -k privileged-usermod$'
    line: "{{ ol8STIG_stigrule_248798__etc_audit_rules_d_audit_rules__usr_sbin_usermod_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248798_Manage
# R-248799 OL08-00-030570
- name: stigrule_248799__etc_audit_rules_d_audit_rules__usr_bin_chacl
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-a always,exit -F path=/usr/bin/chacl -F perm=x -F auid>=1000 -F auid!=unset -k perm_mod$'
    line: "{{ ol8STIG_stigrule_248799__etc_audit_rules_d_audit_rules__usr_bin_chacl_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248799_Manage
# R-248800 OL08-00-030580
- name: stigrule_248800__etc_audit_rules_d_audit_rules__usr_bin_kmod
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-w /usr/bin/kmod -p x -k modules$'
    line: "{{ ol8STIG_stigrule_248800__etc_audit_rules_d_audit_rules__usr_bin_kmod_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248800_Manage
# R-248801 OL08-00-030590
- name: stigrule_248801__etc_audit_rules_d_audit_rules__var_log_faillock
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-w /var/log/faillock -p wa -k logins$'
    line: "{{ ol8STIG_stigrule_248801__etc_audit_rules_d_audit_rules__var_log_faillock_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248801_Manage
# R-248802 OL08-00-030600
- name: stigrule_248802__etc_audit_rules_d_audit_rules__var_log_lastlog
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-w /var/log/lastlog -p wa -k logins$'
    line: "{{ ol8STIG_stigrule_248802__etc_audit_rules_d_audit_rules__var_log_lastlog_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_248802_Manage
# R-248812 OL08-00-030670
- name: stigrule_248812_rsyslog
  yum:
    name: rsyslog
    state: "{{ ol8STIG_stigrule_248812_rsyslog_State }}"
  when: ol8STIG_stigrule_248812_Manage
# R-248814 OL08-00-030690
- name: stigrule_248814_rsyslog_gnutls
  yum:
    name: rsyslog-gnutls
    state: "{{ ol8STIG_stigrule_248814_rsyslog_gnutls_State }}"
  when: ol8STIG_stigrule_248814_Manage
# R-248815 OL08-00-030700
- name: stigrule_248815__etc_audit_auditd_conf
  lineinfile:
    path: /etc/audit/auditd.conf
    regexp: '^overflow_action = '
    line: "{{ ol8STIG_stigrule_248815__etc_audit_auditd_conf_Line }}"
    create: yes
  notify: auditd_restart
  when:
    - ol8STIG_stigrule_248815_Manage
# R-248816 OL08-00-030710
- name: stigrule_248816__etc_rsyslog_conf_DefaultNetstreamDriver
  lineinfile:
    path: /etc/rsyslog.conf DefaultNetstreamDriver
    line: "{{ ol8STIG_stigrule_248816__etc_rsyslog_conf_DefaultNetstreamDriver_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248816_Manage
# R-248816 OL08-00-030710
- name: stigrule_248816__etc_rsyslog_conf_ActionSendStreamDriverMode
  lineinfile:
    path: /etc/rsyslog.conf ActionSendStreamDriverMode
    line: "{{ ol8STIG_stigrule_248816__etc_rsyslog_conf_ActionSendStreamDriverMode_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248816_Manage
# R-248817 OL08-00-030720
- name: stigrule_248817__etc_rsyslog_conf_DefaultNetstreamDriver
  lineinfile:
    path: /etc/rsyslog.conf DefaultNetstreamDriver
    line: "{{ ol8STIG_stigrule_248817__etc_rsyslog_conf_DefaultNetstreamDriver_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248817_Manage
# R-248818 OL08-00-030730
- name: stigrule_248818__etc_audit_auditd_conf_space_left
  lineinfile:
    path: /etc/audit/auditd.conf
    regexp: '^space_left = '
    line: "{{ ol8STIG_stigrule_248818__etc_audit_auditd_conf_space_left_Line }}"
    create: yes
  notify: auditd_restart
  when:
    - ol8STIG_stigrule_248818_Manage
# R-248819 OL08-00-030731
- name: stigrule_248819__etc_audit_auditd_conf_space_left_action
  lineinfile:
    path: /etc/audit/auditd.conf
    regexp: '^space_left_action = '
    line: "{{ ol8STIG_stigrule_248819__etc_audit_auditd_conf_space_left_action_Line }}"
    create: yes
  notify: auditd_restart
  when:
    - ol8STIG_stigrule_248819_Manage
# R-248823 OL08-00-040000
- name: stigrule_248823_telnet_server
  yum:
    name: telnet-server
    state: "{{ ol8STIG_stigrule_248823_telnet_server_State }}"
  when: ol8STIG_stigrule_248823_Manage
# R-248824 OL08-00-040001
- name: stigrule_248824_abrt_
  yum:
    name: abrt*
    state: "{{ ol8STIG_stigrule_248824_abrt__State }}"
  when: ol8STIG_stigrule_248824_Manage
# R-248825 OL08-00-040002
- name: stigrule_248825_sendmail
  yum:
    name: sendmail
    state: "{{ ol8STIG_stigrule_248825_sendmail_State }}"
  when: ol8STIG_stigrule_248825_Manage
# R-248827 OL08-00-040010
- name: stigrule_248827_rsh_server
  yum:
    name: rsh-server
    state: "{{ ol8STIG_stigrule_248827_rsh_server_State }}"
  when: ol8STIG_stigrule_248827_Manage
# R-248836 OL08-00-040070
- name: check if autofs.service is installed
  shell: ! systemctl list-unit-files | grep "^autofs.service[ \t]\+"
  changed_when: False
  check_mode: no
  register: result
  failed_when: result.rc > 1
- name: stigrule_248836_autofs_stop
  service:
    name: autofs.service
    state: "{{ ol8STIG_stigrule_248836_autofs_stop_State }}"
  when:
    - ol8STIG_stigrule_248836_Manage
    - result.rc == 0
# R-248836 OL08-00-040070
- name: check if autofs.service is installed
  shell: ! systemctl list-unit-files | grep "^autofs.service[ \t]\+"
  changed_when: False
  check_mode: no
  register: result
  failed_when: result.rc > 1
- name: stigrule_248836_autofs_disable
  service:
    name: autofs.service
    enabled: "{{ ol8STIG_stigrule_248836_autofs_disable_Enabled }}"
  when:
    - ol8STIG_stigrule_248836_Manage
    - result.rc == 0
# R-248840 OL08-00-040100
- name: stigrule_248840_firewalld_noarch
  yum:
    name: firewalld.noarch
    state: "{{ ol8STIG_stigrule_248840_firewalld_noarch_State }}"
  when: ol8STIG_stigrule_248840_Manage
# R-248841 OL08-00-040101
- name: check if firewalld.service is installed
  shell: ! systemctl list-unit-files | grep "^firewalld.service[ \t]\+"
  changed_when: False
  check_mode: no
  register: result
  failed_when: result.rc > 1
- name: stigrule_248841_firewalld_enable
  service:
    name: firewalld.service
    enabled: "{{ ol8STIG_stigrule_248841_firewalld_enable_Enabled }}"
  when:
    - ol8STIG_stigrule_248841_Manage
    - result.rc == 0
# R-248841 OL08-00-040101
- name: check if firewalld.service is installed
  shell: ! systemctl list-unit-files | grep "^firewalld.service[ \t]\+"
  changed_when: False
  check_mode: no
  register: result
  failed_when: result.rc > 1
- name: stigrule_248841_firewalld_start
  service:
    name: firewalld.service
    state: "{{ ol8STIG_stigrule_248841_firewalld_start_State }}"
  when:
    - ol8STIG_stigrule_248841_Manage
    - result.rc == 0
# R-248842 OL08-00-040110
- name: check if wireless network adapters are disabled
  shell: "[[ $(nmcli radio wifi) == 'enabled' ]]"
  changed_when: False
  check_mode: no
  register: cmd_result
  failed_when: cmd_result.rc > 1
- name: stigrule_248842_nmcli_radio_wifi_off
  shell: "{{ ol8STIG_stigrule_248842_nmcli_radio_wifi_off_Command }}"
  when:
    - ol8STIG_stigrule_248842_Manage
    - cmd_result.rc == 0
# R-248866 OL08-00-040159
- name: stigrule_248866_openssh_server_x86_64
  yum:
    name: openssh-server.x86_64
    state: "{{ ol8STIG_stigrule_248866_openssh_server_x86_64_State }}"
  when: ol8STIG_stigrule_248866_Manage
# R-248868 OL08-00-040161
- name: stigrule_248868_RekeyLimit
  lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '(?i)^\s*RekeyLimit\s+'
    line: "{{ ol8STIG_stigrule_248868_RekeyLimit_Line }}"
  notify: ssh_restart
  when:
    - ol8STIG_stigrule_248868_Manage
    - "'openssh-server' in packages"
# R-248869 OL08-00-040170
- name: stigrule_248869_systemctl_mask_ctrl_alt_del_target
  systemd:
    name: ctrl-alt-del.target
    enabled: no
    masked: yes
  when:
    - ol8STIG_stigrule_248869_Manage
# R-248870 OL08-00-040171
- name: stigrule_248870_net_ipv4_conf_all_send_redirects
  sysctl:
    name: net.ipv4.conf.all.send_redirects
    value: "{{ ol8STIG_stigrule_248870_net_ipv4_conf_all_send_redirects_Value }}"
  when:
    - ol8STIG_stigrule_248870_Manage
# R-248871 OL08-00-040172
- name: stigrule_248871__etc_systemd_system_conf
  ini_file:
    path: /etc/systemd/system.conf
    section: Manager
    option: CtrlAltDelBurstAction
    value: "{{ ol8STIG_stigrule_248871__etc_systemd_system_conf_Value }}"
    no_extra_spaces: yes
  notify: dconf_update
  when:
    - ol8STIG_stigrule_248871_Manage
    - "'dconf' in packages"
# R-248872 OL08-00-040180
- name: check if ipv6 is enabled
  shell: "[[ $(cat /sys/module/ipv6/parameters/disable) == '0' ]]"
  changed_when: False
  check_mode: no
  register: cmd_result
  failed_when: cmd_result.rc > 1
- name: stigrule_248872_net_ipv6_conf_default_accept_redirects
  sysctl:
    name: net.ipv6.conf.default.accept_redirects
    value: "{{ ol8STIG_stigrule_248872_net_ipv6_conf_default_accept_redirects_Value }}"
  when:
    - ol8STIG_stigrule_248872_Manage
    - cmd_result.rc == 0
# R-248873 OL08-00-040190
- name: stigrule_248873_tftp_server
  yum:
    name: tftp-server
    state: "{{ ol8STIG_stigrule_248873_tftp_server_State }}"
  when: ol8STIG_stigrule_248873_Manage
# R-248875 OL08-00-040209
- name: stigrule_248875_net_ipv4_conf_default_accept_redirects
  sysctl:
    name: net.ipv4.conf.default.accept_redirects
    value: "{{ ol8STIG_stigrule_248875_net_ipv4_conf_default_accept_redirects_Value }}"
  when:
    - ol8STIG_stigrule_248875_Manage
# R-248878 OL08-00-040230
- name: stigrule_248878_net_ipv4_icmp_echo_ignore_broadcasts
  sysctl:
    name: net.ipv4.icmp_echo_ignore_broadcasts
    value: "{{ ol8STIG_stigrule_248878_net_ipv4_icmp_echo_ignore_broadcasts_Value }}"
  when:
    - ol8STIG_stigrule_248878_Manage
# R-248879 OL08-00-040239
- name: stigrule_248879_net_ipv4_conf_all_accept_source_route
  sysctl:
    name: net.ipv4.conf.all.accept_source_route
    value: "{{ ol8STIG_stigrule_248879_net_ipv4_conf_all_accept_source_route_Value }}"
  when:
    - ol8STIG_stigrule_248879_Manage
# R-248880 OL08-00-040240
- name: check if ipv6 is enabled
  shell: "[[ $(cat /sys/module/ipv6/parameters/disable) == '0' ]]"
  changed_when: False
  check_mode: no
  register: cmd_result
  failed_when: cmd_result.rc > 1
- name: stigrule_248880_net_ipv6_conf_all_accept_source_route
  sysctl:
    name: net.ipv6.conf.all.accept_source_route
    value: "{{ ol8STIG_stigrule_248880_net_ipv6_conf_all_accept_source_route_Value }}"
  when:
    - ol8STIG_stigrule_248880_Manage
    - cmd_result.rc == 0
# R-248881 OL08-00-040249
- name: stigrule_248881_net_ipv4_conf_default_accept_source_route
  sysctl:
    name: net.ipv4.conf.default.accept_source_route
    value: "{{ ol8STIG_stigrule_248881_net_ipv4_conf_default_accept_source_route_Value }}"
  when:
    - ol8STIG_stigrule_248881_Manage
# R-248882 OL08-00-040250
- name: check if ipv6 is enabled
  shell: "[[ $(cat /sys/module/ipv6/parameters/disable) == '0' ]]"
  changed_when: False
  check_mode: no
  register: cmd_result
  failed_when: cmd_result.rc > 1
- name: stigrule_248882_net_ipv6_conf_default_accept_source_route
  sysctl:
    name: net.ipv6.conf.default.accept_source_route
    value: "{{ ol8STIG_stigrule_248882_net_ipv6_conf_default_accept_source_route_Value }}"
  when:
    - ol8STIG_stigrule_248882_Manage
    - cmd_result.rc == 0
# R-248883 OL08-00-040260
- name: stigrule_248883_net_ipv4_ip_forward
  sysctl:
    name: net.ipv4.ip_forward
    value: "{{ ol8STIG_stigrule_248883_net_ipv4_ip_forward_Value }}"
  when:
    - ol8STIG_stigrule_248883_Manage
# R-248883 OL08-00-040260
- name: check if ipv6 is enabled
  shell: "[[ $(cat /sys/module/ipv6/parameters/disable) == '0' ]]"
  changed_when: False
  check_mode: no
  register: cmd_result
  failed_when: cmd_result.rc > 1
- name: stigrule_248883_net_ipv6_conf_all_forwarding
  sysctl:
    name: net.ipv6.conf.all.forwarding
    value: "{{ ol8STIG_stigrule_248883_net_ipv6_conf_all_forwarding_Value }}"
  when:
    - ol8STIG_stigrule_248883_Manage
    - cmd_result.rc == 0
# R-248884 OL08-00-040261
- name: check if ipv6 is enabled
  shell: "[[ $(cat /sys/module/ipv6/parameters/disable) == '0' ]]"
  changed_when: False
  check_mode: no
  register: cmd_result
  failed_when: cmd_result.rc > 1
- name: stigrule_248884_net_ipv6_conf_all_accept_ra
  sysctl:
    name: net.ipv6.conf.all.accept_ra
    value: "{{ ol8STIG_stigrule_248884_net_ipv6_conf_all_accept_ra_Value }}"
  when:
    - ol8STIG_stigrule_248884_Manage
    - cmd_result.rc == 0
# R-248885 OL08-00-040262
- name: check if ipv6 is enabled
  shell: "[[ $(cat /sys/module/ipv6/parameters/disable) == '0' ]]"
  changed_when: False
  check_mode: no
  register: cmd_result
  failed_when: cmd_result.rc > 1
- name: stigrule_248885_net_ipv6_conf_default_accept_ra
  sysctl:
    name: net.ipv6.conf.default.accept_ra
    value: "{{ ol8STIG_stigrule_248885_net_ipv6_conf_default_accept_ra_Value }}"
  when:
    - ol8STIG_stigrule_248885_Manage
    - cmd_result.rc == 0
# R-248886 OL08-00-040270
- name: stigrule_248886_net_ipv4_conf_default_send_redirects
  sysctl:
    name: net.ipv4.conf.default.send_redirects
    value: "{{ ol8STIG_stigrule_248886_net_ipv4_conf_default_send_redirects_Value }}"
  when:
    - ol8STIG_stigrule_248886_Manage
# R-248887 OL08-00-040279
- name: stigrule_248887_net_ipv4_conf_all_accept_redirects
  sysctl:
    name: net.ipv4.conf.all.accept_redirects
    value: "{{ ol8STIG_stigrule_248887_net_ipv4_conf_all_accept_redirects_Value }}"
  when:
    - ol8STIG_stigrule_248887_Manage
# R-248888 OL08-00-040280
- name: check if ipv6 is enabled
  shell: "[[ $(cat /sys/module/ipv6/parameters/disable) == '0' ]]"
  changed_when: False
  check_mode: no
  register: cmd_result
  failed_when: cmd_result.rc > 1
- name: stigrule_248888_net_ipv6_conf_all_accept_redirects
  sysctl:
    name: net.ipv6.conf.all.accept_redirects
    value: "{{ ol8STIG_stigrule_248888_net_ipv6_conf_all_accept_redirects_Value }}"
  when:
    - ol8STIG_stigrule_248888_Manage
    - cmd_result.rc == 0
# R-248889 OL08-00-040281
- name: stigrule_248889__etc_sysctl_d_99_sysctl_conf
  lineinfile:
    path: /etc/sysctl.d/99-sysctl.conf
    regexp: '^kernel.unprivileged_bpf_disabled = '
    line: "{{ ol8STIG_stigrule_248889__etc_sysctl_d_99_sysctl_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248889_Manage
# R-248890 OL08-00-040282
- name: stigrule_248890__etc_sysctl_d_99_sysctl_conf
  lineinfile:
    path: /etc/sysctl.d/99-sysctl.conf
    regexp: '^kernel.yama.ptrace_scope = '
    line: "{{ ol8STIG_stigrule_248890__etc_sysctl_d_99_sysctl_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248890_Manage
# R-248890 OL08-00-040282
- name: stigrule_248890_kernel_yama_ptrace_scope
  sysctl:
    name: kernel.yama.ptrace_scope
    value: "{{ ol8STIG_stigrule_248890_kernel_yama_ptrace_scope_Value }}"
  when:
    - ol8STIG_stigrule_248890_Manage
# R-248891 OL08-00-040283
- name: stigrule_248891__etc_sysctl_d_99_sysctl_conf
  lineinfile:
    path: /etc/sysctl.d/99-sysctl.conf
    regexp: '^kernel.kptr_restrict = '
    line: "{{ ol8STIG_stigrule_248891__etc_sysctl_d_99_sysctl_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248891_Manage
# R-248892 OL08-00-040284
- name: stigrule_248892__etc_sysctl_d_99_sysctl_conf
  lineinfile:
    path: /etc/sysctl.d/99-sysctl.conf
    regexp: '^user.max_user_namespaces = '
    line: "{{ ol8STIG_stigrule_248892__etc_sysctl_d_99_sysctl_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248892_Manage
# R-248892 OL08-00-040284
- name: stigrule_248892_user_max_user_namespaces
  sysctl:
    name: user.max_user_namespaces
    value: "{{ ol8STIG_stigrule_248892_user_max_user_namespaces_Value }}"
  when:
    - ol8STIG_stigrule_248892_Manage
# R-248893 OL08-00-040285
- name: stigrule_248893__etc_sysctl_d_99_sysctl_conf
  lineinfile:
    path: /etc/sysctl.d/99-sysctl.conf
    regexp: '^net.ipv4.conf.all.rp_filter = '
    line: "{{ ol8STIG_stigrule_248893__etc_sysctl_d_99_sysctl_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248893_Manage
# R-248894 OL08-00-040286
- name: stigrule_248894__etc_sysctl_d_99_sysctl_conf
  lineinfile:
    path: /etc/sysctl.d/99-sysctl.conf
    regexp: '^net.core.bpf_jit_harden = '
    line: "{{ ol8STIG_stigrule_248894__etc_sysctl_d_99_sysctl_conf_Line }}"
    create: yes
  when:
    - ol8STIG_stigrule_248894_Manage
# R-248900 OL08-00-040340
- name: stigrule_248900_X11Forwarding
  lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '(?i)^\s*X11Forwarding\s+'
    line: "{{ ol8STIG_stigrule_248900_X11Forwarding_Line }}"
  notify: ssh_restart
  when:
    - ol8STIG_stigrule_248900_Manage
    - "'openssh-server' in packages"
# R-248901 OL08-00-040341
- name: stigrule_248901_X11UseLocalhost
  lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '(?i)^\s*X11UseLocalhost\s+'
    line: "{{ ol8STIG_stigrule_248901_X11UseLocalhost_Line }}"
  notify: ssh_restart
  when:
    - ol8STIG_stigrule_248901_Manage
    - "'openssh-server' in packages"
# R-248903 OL08-00-040360
- name: stigrule_248903_vsftpd
  yum:
    name: vsftpd
    state: "{{ ol8STIG_stigrule_248903_vsftpd_State }}"
  when: ol8STIG_stigrule_248903_Manage
# R-248904 OL08-00-040370
- name: stigrule_248904_gssproxy
  yum:
    name: gssproxy
    state: "{{ ol8STIG_stigrule_248904_gssproxy_State }}"
  when: ol8STIG_stigrule_248904_Manage
# R-248905 OL08-00-040380
- name: stigrule_248905_iprutils
  yum:
    name: iprutils
    state: "{{ ol8STIG_stigrule_248905_iprutils_State }}"
  when: ol8STIG_stigrule_248905_Manage
# R-248906 OL08-00-040390
- name: stigrule_248906_tuned
  yum:
    name: tuned
    state: "{{ ol8STIG_stigrule_248906_tuned_State }}"
  when: ol8STIG_stigrule_248906_Manage
# R-256979 OL08-00-010358
- name: stigrule_256979_mailx
  yum:
    name: mailx
    state: "{{ ol8STIG_stigrule_256979_mailx_State }}"
  when: ol8STIG_stigrule_256979_Manage
# R-274876 OL08-00-030645
- name: stigrule_274876__etc_audit_rules_d_audit_rules__etc_cron_d__cronjobs
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-w /etc/cron.d/ -p wa -k cronjobs$'
    line: "{{ ol8STIG_stigrule_274876__etc_audit_rules_d_audit_rules__etc_cron_d__cronjobs_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_274876_Manage
# R-274876 OL08-00-030645
- name: stigrule_274876__etc_audit_rules_d_audit_rules__var_spool_cron__cronjobs
  lineinfile:
    path: /etc/audit/rules.d/audit.rules
    regexp: '^-w /var/spool/cron/ -p wa -k cronjobs$'
    line: "{{ ol8STIG_stigrule_274876__etc_audit_rules_d_audit_rules__var_spool_cron__cronjobs_Line }}"
  notify: auditd_restart
  when: ol8STIG_stigrule_274876_Manage
